---
import PageLayout from '../layouts/BaseLayout.astro'
import Section from '../components/Section.astro'
import Timeline from '../components/Timeline'

import { parseProjectsYaml, getLiveProjects } from '../../packages/shared/src/lib/projects'
import projectsYaml from '../../packages/shared/src/data/projects.yaml?raw'
import ProjectCard from '../../packages/shared/src/components/ProjectCard.astro'

import fs from 'fs'
import yaml from 'js-yaml'
import path from 'path'

// Load timeline data
const timelineYaml = fs.readFileSync(path.join(process.cwd(), 'src/data/timeline.yaml'), 'utf8')
const timelineData = yaml.load(timelineYaml) as { timeline: any[] }

// Load projects
const allProjects = parseProjectsYaml(projectsYaml)
const liveProjects = getLiveProjects(allProjects)
---

<PageLayout meta={{ title: 'About' }}>
	<div class='flex w-full flex-col gap-y-10'>
		<Section title='About'>
			<p class='text-muted-foreground'>
				Data science leader with 10+ years of experience in experimentation, analytics, and product
				development. Currently leading data science initiatives at Starbucks, focusing on customer
				behavior modeling and A/B testing at scale.
			</p>
			<p class='mt-4 text-muted-foreground'>
				I believe the best way to understand data is to build the system that creates it. That's why I build 
				end-to-end products in my personal time—not to replace engineers, but to understand the tradeoffs 
				firsthand. It makes me a better collaborator and a more credible leader.
			</p>
		</Section>

		<Section title='Experience'>
			<Timeline client:load items={timelineData.timeline} />
		</Section>

		{liveProjects.length > 0 && (
			<Section title='Projects'>
				<p class='mb-4 text-muted-foreground'>
					Interactive tools built end-to-end with AI assistance.
				</p>
				<div class='space-y-3'>
					{liveProjects.map((project) => (
						<ProjectCard project={project} variant='compact' />
					))}
				</div>
				<a 
					href='/projects' 
					class='mt-4 inline-flex items-center text-sm text-muted-foreground hover:text-foreground transition'
				>
					View all projects →
				</a>
			</Section>
		)}
	</div>
</PageLayout>
